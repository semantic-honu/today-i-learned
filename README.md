# today-i-learned
A collection of things I learned today.  
今日学んだことの記録を書いていきます。


## 2025年
### 9月4日
 - セキュリティ
   -​ CVE-2025-9074の概要
      - ​影響を受ける製品: Docker Desktop for WindowsおよびmacOS
​脆弱性の種類: コンテナからの特権昇格（コンテナエスケープ）。
      - ​脆弱性の詳細:
デフォルト設定のDockerサブネット経由で、悪意のあるローカルのコンテナが、認証なしでDocker EngineのAPIに直接アクセスできてしまう脆弱性です。
      - ​なぜ危険か:
この脆弱性を悪用されると、攻撃者はコンテナ内からホスト側のDocker Engineを制御できるようになります。これにより、他のコンテナを操作したり、新しいコンテナを作成したり、さらにはホストのドライブをマウントして、ホストOS上のファイルにアクセスすることが可能になります。
      - ​CVSSスコア:
脆弱性の深刻度を示すCVSSv4.0のベーススコアは9.3で、最も高い「Critical（クリティカル）」に分類されています。
    - 考察：​開発・検証ツールであるDocker Desktopが本番運用されることは通常あり得ない。しかし、現実にはそのようなケースが存在し、脆弱な状態が放置されるリスクがある。セキュリティは技術的な対策だけでなく、組織や人間の運用まで含めて考えるべき。


### 9月3日
 - springboot
   - レイアウトを改善するにはBootstrapやTailwindCSSが適している。手軽なのはBootstrapで`<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" `をheadに追加するだけ。
   - ログアウト時はSessionやCookieを無効にする処理を入れる。
```
.logoutSuccessUrl("/login?logout")
.invalidateHttpSession(true)
.deleteCokkies("JSESSIONID")
```
   - 親子テーブルを関連付ける場合は@OneToMany,@ManyToOne,@JoinColumnアノテーションをエンティのキーに付与する。

- ​顔認証とログイン: 顔認証は、端末のロック解除だけでなく、アプリやサービスへのログインにも使われる。
- ​多要素認証（MFA）: SMS認証やメール認証はフィッシングに弱い。顔認証のような生体認証は、デバイス内で認証が完結するため、フィッシング耐性が高い。
- ​パスキー: デバイスの生体認証と公開鍵暗号技術を組み合わせた、フィッシングに非常に強い新しい認証方式。
- ​Javaの環境変数: Oracleの公式JDKインストーラーは環境変数を自動設定しないため、手動設定が必要な場合がある。Scoopのようなパッケージマネージャーを使うと、この作業を自動化できて便利。
- ​GitHubのセキュリティ:
​ライセンス: GitHubのWebサイトから、後付けでライセンス（例: MIT）を簡単に設定できる。
- ​Dependabot: 依存ライブラリの脆弱性を自動でスキャンしてくれるツール。HighやCriticalな脆弱性が見つかった場合は、優先的に対応する。
- ​履歴の削除: 履歴をまっさらにしたい場合は、git checkout --orphanコマンドで履歴のない新しいブランチを作り、git push -fで強制的に上書きする。事前に.gitignoreが正しく設定されているか確認することが重要。
- IDEの機能: Android StudioにはMarkdownのプレビュー機能が標準で搭載されていないが、VS Codeのような他のエディタや、IntelliJ IDEAには標準で搭載されている。


### 9月2日
- Springboot
  - spring-boot-starter-security: セキュリティのコアライブラリ。追加するだけで自動的に基本的なログインフォームと認証機能が有効になる。
  - thymeleaf-extras-springsecurity6: Thymeleafテンプレートの中で認証機能にアクセスするために必須。
  - UserDetailsを実装したUserクラスで値を保持。UserRepositoryを実装し、SecurityConfig.javaを作る。AuthControllerを実装、認証関連の遷移を担当。

- セキュリティ
   - 暗号化されてないメモリダンプ上の脆弱性
     - ブラウザのパスワード：ウェブサイトにログインするために保存したパスワード。
     - オペレーティングシステムのログイントークン：WindowsまたはmacOSへの認証に使用されるトークン。
     - APIキーと証明書：アプリケーションが他のサービスと通信するためのキー。
   * ISIS（Intermediate System to Intermediate System）:
     * 大規模ネットワークで使用されるルーティングプロトコル。
     * ルーター間でネットワークの経路情報を交換し、データ転送の最適ルートを決定する。
   * CVE-2025-20241 脆弱性:
     * CiscoのNexusルーターに存在するISIS関連の脆弱性。
     * 悪用されるとサービス拒否（DoS）攻撃を引き起こす可能性がある。
     * CVSSスコアは7.4（High）。これは、リモートから攻撃可能で、システムの可用性に完全な影響を与えるため。
   * DoS攻撃の多様性:
     * 従来のDDoS攻撃は、ボットネットによるトラフィックの大量送信が主流。
     * 今回の脆弱性は、細工された単一のパケットでデバイスをクラッシュさせることが可能で、ボットネットが不要。
   * 脆弱性の原因:
     * 多くの場合、ソフトウェアのバグよりも、設定ミスが原因となる。
     * CDNの環境設定の不備や、APIキーの GitHubへの公開など、基本的なセキュリティ管理のミスが多い。
     * 多くの脆弱性は、開発者が想定しない極端な値や操作（整数アンダーフロー、ディレクトリトラバーサルなど）を悪用して発見される。
   * セキュリティと人間性:
     * 企業が脆弱性報告を軽視したり、不当に扱ったりすることが、善意のハッカーの心を傷つけ、悪意ある行動につながる可能性がある。
     * セキュリティの問題は、技術だけでなく、企業の文化や人間の心理に深く根ざしている。
     * 優れたセキュリティ研究者は、技術だけでなく、その背後にある人間的な側面（葛藤、不公平、報われない努力など）も理解している。

- picoCTF
  - nc(netcat): ポートへの平文接続。
  - wget: ネットからファイルをダウンロード。
  - fdisk,mmls: パーテーションの情報を得る。
  - foremost: ディスクからファイルを抽出。
  - fls,icat: 削除されたファイルの探索。


### 9月1日
- Springboot
  - `GetMapping("tasks/{id}")`でid=1として可変パラメーターが渡る。
  - @PathVariableでメソッドの引数に引き渡し、JPAの`findById`でDBから検索。`isPresent`でModelに追加して画面遷移。
  - `<a th:href="@/tasks/{id}(id=${task.id})"`とし、{id}に値を渡す。
  - 遅延ロード:
    - 一度にすべてを読み込むのではなく、必要になったときに必要な分を取得する方法。大規模アプリケーションではメモリの消費を抑え処理を高速化させるために重要となる。
  - update時はModelにsetIdをして、新規登録でなく更新として認識させる。
  - *はフォームをバインドするオブジェクトのプロパティを指す。`*{completed}`=`${task.completed}`
  - class属性を指定して、cssを一括適用させる。
  - @ValidアノテーションをEntityに付与することによってバリデーションを実行する。BindingResultがバリデーション結果を保持する。フォーム側（Thymeleaf側）では#fieldsからバリデーション結果を受け取る。
  - formにrequiredを付けるとフォームで入力チェックが行われる。novalidateをつけると行わない。

- DevContainer
  * DevContainer (開発コンテナ) は、開発環境をDockerコンテナとして定義し、チーム全員に統一された環境を提供するためのツール。
  * DevContainerは、Dockerと、主にVisual Studio CodeやJetBrainsのIDEの連携によって実現される。
  * プロジェクトのルートにある**.devcontainer**フォルダ内のdevcontainer.jsonファイルに、環境設定を記述する。
  * **pre-commitやpre-push**といったGitフックは、コミットやプッシュの直前にコードの品質チェックを自動実行する仕組み。
 * pre-commitでやるべきこと
   * コードの自動整形（フォーマット）:
     * 目的: チームのコーディングスタイルを統一する。
     * 具体的な行動: インデント、スペース、改行などを自動で修正する。
     * ツール例: Prettier、Black
   * Linter（静的解析ツール）の実行:
     * 目的: 潜在的なバグやコーディング規約違反を検出する。
     * 具体的な行動: 使われていない変数の検出、文法エラー、不適切な構文などをチェックする。
     * ツール例: ESLint、flake8
   * コミット対象ファイルのみに限定して実行:
     * 目的: チェックに要する時間を短縮し、開発体験を向上させる。
     * 具体的な行動: git addされたファイルだけを対象にフォーマットやLinterを実行する。
     * ツール例: lint-staged
 * pre-pushでやるべきこと  
    * ユニットテストの実行:
      * 目的: コードのロジックが期待通りに動作するか検証する。
      * 具体的な行動: ローカルでユニットテストやインテグレーションテストを実行し、テストがすべてパスすることを確認する。
      * ツール例: Jest、pytest、RSpec
    * 型チェック:
      * 目的: 型に関するエラーを早期に発見し、バグを防ぐ。
      * 具体的な行動: コードに型エラーがないか検証する。
      * ツール例: TypeScript、mypy
 * DevContainerでGitフックの設定を共有することで、チーム全体のコード規約や品質基準を自動で保つことができる。
 * 開発環境はDevContainerで統一し、本番環境は最小限の要素のみで構成された別のDockerイメージをCI/CDでビルドするのが一般的。

- セキュリティ
  * ログの無効化攻撃:
    * /var/logのようなログ保存ディレクトリに同名の空ファイルを作ると、システムがログを記録できなくなる。
    * これは管理者権限がなければ実行できず、主にSIEMなどによる監視を回避し、痕跡を消すために行われる。
  * CDNとXFFヘッダー:
    * CDN経由の攻撃では、通信元のIPアドレスがCDNのものになるため、安易にそのIPをブロックすると無関係のユーザーに影響が出る。
    * 攻撃の真のIPはXFF（X-Forwarded-For）ヘッダーで特定できるが、このヘッダーは偽装可能なため、信頼できるプロキシを経由した通信でなければ信用できない。
  * ClickFix攻撃の仕組み: 
   * ユーザーを騙して、クリップボードにコピーされた悪意のあるコマンドを自ら実行させるソーシャルエンジニアリング攻撃。これにより、従来のセキュリティ対策を回避する。
  * インフォスティーラーの脅威: 
   * ClickFix攻撃の主な目的の一つ。ブラウザのパスワードや認証情報などを盗み、攻撃者のサーバーに送信する。
  * ​インフォスティーラーやDDoS攻撃のツールが「SaaS」のように取引されている。


### 8月31日
- springboot
  - EntityクラスはModelパッケージ下に置き、`@Entity`アノテーションを付ける。`@Id`アノテーションでIdを特定し、自動採番は`@GeneratedValue`アノテーションで指定。
```
1. GenerationType.IDENTITYは、データベースのAUTO_INCREMENT（MySQLなど）に依存。﻿
2. GenerationType.SEQUENCEは、データベースのシーケンスを使用。﻿
3. GenerationType.AUTOは、使用するデータベースに応じて適切な戦略を自動的に選択。﻿
```
  - `@Repositrory`でデータベースアクセスコンポーネントだと宣言。`extends JpaRepository`でSpringDataJPAのインターフェースを継承、CRUDを自動作成。第一引数にエンティティクラス、第二引数に主キーの型。
  - 主キーをLongとして定義することにより、オートボクシングによるnullPointerExceptionを防止する。
  - Modelを使ってコントローラーをからveiwにデータを渡す。
  - デフォルトではsrc/main/resources/templatesにhtmlを探しに行く。
  - SpingDataJPAにより、@Entityを解析しH2Databaseなどの設定されたデータベースを自動的にと構築する。
  - application.propertiesに設定:`sping-jpa.hibernate.ddl-auto=update`で差分を反映。
  - H2 Databaseはインメモリモードとファイルモードがある。
- Linux
  - `sudo ifdown eth0`もしくは`sudo ip link set dev eth0 down`でサーバーをネットワーク環境から即座にきりはなせる。
  - `sudo ufw deny from any to any`はFWですべてを拒否。
  - `sudo pkill -KILL -u 攻撃者のユーザー名`でsshプロセスをキル。
  - 権限昇格の可能性を考えると物理的にケーブルを抜く、クラウド環境ならコンソールからネットワーク設定を変更してアクセスを遮断。状況によってはシャットダウンを試みる。証拠保全の観点からは良くないかも。
- サーバーダウンから読み解くWebアプリケーションのアーキテクチャとセキュリティ
  - ​テンプレート構文の剥き出し: HTMLに{{...}}のようなテンプレート構文がそのまま表示されるのは、アプリケーションサーバー（APサーバー）がダウンしている可能性が高い。Webサーバーが静的なHTMLファイルのみを返し、動的な処理（テンプレートのレンダリング）が実行されていない状態。
  - ​CSSが適用されない原因: APサーバーがダウンしているため、APサーバー内で管理されているCSSファイルや、動的に生成されるCSSが配信されず、デザインが崩れる。
  - ​技術スタックの推測: {{...}}構文と、求人情報などの公開情報を組み合わせることで、フロントエンドはVue.jsやAngular、バックエンドはSpring Boot（Java）、インフラはAWSといった技術スタックを推測できる（OSINT）。
  - ​サーバーダウンの根本原因:
​オートスケーリングの上限が低く設定されている（コスト削減のためなど）。
​アプリケーションにメモリリークなどのバグがある（Javaのガベージコレクションでも発生しうる）。
​DDoS攻撃への対応として、オートスケーリングの上限を高く設定すると、コストが増大するリスクがある。
  - ​セキュリティとベストプラクティス:
​ベストプラクティスは開発効率を高めるが、攻撃者にとっても予測可能なシステムになる。
  - ​セキュリティを高めるには、ベストプラクティスを遵守しつつ、デフォルト設定（ディレクトリ構成、ポート番号など）を少し変えることが有効。これにより、多くの自動化されたBotによる攻撃を防げる。

 * V8エンジンの脆弱性（CVE-2025-5419）: Google ChromeのJavaScriptエンジン「V8」の最適化処理のバグに起因する脆弱性。
   * ヒープ汚染（Heap Corruption）: 本来のヒープ領域が意図せず上書きされる現象。
   * 原因: V8のStore-Store Eliminationという最適化処理が、特定の条件下で観測点を誤認し、不要なストア（メモリへの書き込み）を削除したため。
   * 結果: あるはずのデータがメモリになく、未初期化のメモリ領域が生じた。
 * 攻撃のステップ（エクスプロイトチェーン）:
   * 情報漏えいプリミティブ: 未初期化のメモリに残ったゴミデータから、メモリ上のアドレス情報を盗み出す。
   * フェイクオブジェクト化: 盗んだアドレス情報を使い、メモリ上に偽のオブジェクトを構築する。
   * 任意アドレス読み書き: 偽のオブジェクトを通じて、メモリ上の任意のアドレスを自由に読み書きする能力を得る。
   * RCE（リモートからのコード実行）: 最終的に、正規のコード領域を悪意のあるコードで上書きし、実行を乗っ取る。
 * セキュリティ技術の回避:
   * ASLR（Address Space Layout Randomization）: 本来、メモリ上のアドレスをランダム化して攻撃を防ぐ技術。情報漏えいプリミティブによって、この技術がバイパスされる。
   * DEP（Data Execution Prevention）/ W^X: データ領域（ヒープ）でコードが実行されるのを防ぐ技術。任意アドレス読み書き能力で、この技術も回避される。
 * ハッカーの手法とAI:
   * ヒープスプレー: 攻撃コードをメモリ上に配置する手法。
   * APT（持続的標的型攻撃）: 特定の標的を狙う高度な攻撃で、このような高コストな脆弱性が使用されやすい。
   * BigInt（n）: 64ビットアドレスのような大きな整数を正確に扱うためのJavaScriptの新しいデータ型。
   * Big Sleep: AIが自律的に脆弱性を発見するGoogleのシステム。AIの進化により、脆弱性発見のスピードが飛躍的に向上している。
 * ITの基礎:
   * 64ビットアーキテクチャ: アドレス空間の基本長が64ビット（8バイト）で、膨大なメモリを扱える。
   * JITコンパイラ: 実行時にコードを機械語に変換し、高速化する仕組み。今回の脆弱性は、そのコンパイラ部分のバグ。
   * 数値の表記: 16進数（0xFFFFnなど）は、長くなる2進数を人間が扱いやすくするための表記法。


### 8月30日
 * OAuth事前承認制: クライアントがユーザーに許可を求める前に、API提供者がそのアプリケーションを事前に審査・承認する仕組み。SSOの文脈でセキュリティを高める目的で使われる。
 * パスワードリセットのメッセージ: パスワードリセット時に「入力されたメールアドレスに案内を送信しました」のように、登録済みか未登録かを区別しないメッセージは、アカウント列挙攻撃を防ぐためのセキュリティ対策である。
 * ハッカーの「コスパ」: 多くのサイバー攻撃は、高度な技術よりも、効率と費用対効果（コストパフォーマンス）を重視した手法（パスワードの使い回しを狙うリスト型攻撃など）で行われる。
 * 既知リークパスワードの検疫: ユーザーが設定するパスワードが、過去のデータ漏洩で流出していないかをチェックするセキュリティ機能。パスワードマネージャーなどに搭載されている。
 * APTとルーター制圧: 国家レベルのAPTは、通信プロバイダーのルーターを乗っ取り、トラフィックの経路を変更して通信内容を盗聴するなど、非常に高度な攻撃を行う。
 * 日本発のOSS: プログラミング言語のRubyや、データ収集ツールFluentdなど、日本発で世界的に評価されているオープンソースソフトウェアも存在する。
 * OSSへの貢献: コードを書くことだけでなく、機能要望やバグ報告をIssueとして投稿することも、OSSへの重要な貢献となる。


### 8月29日
- VirtualBoxメジャーアップデート後はGuestAdditionsのアップデートも行うことを学びましました。
  - GuestAdditionsはホストとゲスト間の連携を強化するためのドライバ、アプリケーションセット。マウスを統合したり、ファイルを共有したり、画面を可変にしたり。
- GUIが固まったときは`Ctrl+Alt+F3`でCUIログインに切り替わる。`sudo reboot`で再起動を試す。

- picoCTF(webエクスプロイト)
  - テンプレートインジェクションと、グローバル変数の関係を学びました。
    - Flaskではself、request.applicationを起点としてアクセスできる。
    - サニタイズ不足の環境で、プログラムをアップロードしてコマンドを実行する。Nullバイト`%00`を使った攻撃手法。
- WEBアプリケーション脆弱性診断の講習を受講しました。
  - 脆弱性診断の業務内容
  - 使われるプロトコルや、Session、Cookieの技術的概念
  - Burp Suiteを用いたXSSインジェクションの実演
  - DOM型、反射型
  - 文字エンコードで検知を回避、エンコードのエンコード
  - Challenge問題に挑戦
-アカウント列挙攻撃はレート制限、メッセージ制限を行って対策することを学びました。


### 8月28日
- picoCTF
  - zsteg を使ってみました。できることは以下。
   1. LSB (Least Significant Bit) 解析
   2. ファイルヘッダーの検出
   3. ​隠されたテキストの抽出
  - `echo "見つかったbase64文字列" | base64 -d`でbase64デコードができる。
  - ​.pcapファイルはパケットキャプチャファイルをwiresharkとtsharkで解析。tcpペイロードを取り出す。
  - sha256sumでハッシュ値を生成する。
  - zbar-toolsでQRコードを解析する。
- Windowsのシステム整合性修復の方法を学びました。  
```
ログチェック:イベントビューア
診断：DISM /Online /Cleanup-image /ScanHealth
​修復：DISM /Online /Cleanup-image /RestoreHealth
​システムファイルの整合性チェック：sfc /scannow
```
- wingetのアップデート問題：メジャーバージョンアップグレードの特性を理解して手動で対応
- ログイン前のキーボード設定の修正方法を学びました。  
`sudo vim /etc/default/keyboard``sudo dpkg-reconfigure keyboard-configuration
`
- サイバーセキュリティ
  - 侵入方法とRaaSの分業体制を学びました。  
攻撃者は侵入と権限昇格までを行い、RaaSとは分業である。RaaSはLiving off the Land、certutilやbitsadmin、MWIなど標準ツールの悪用が主流となっている。



### 8月27日
- Git＆GitHub
  - Gitのコマンドについて学習しました。`git add .`の危険性を理解し、`git add <file>`の重要性を学びました。  
→コミットは意味のある単位で行うことが重要。
  - GitHubの`TIL`（Today I Learned）というプラクティスについて調べ、実践しました。  
→アウトプットと手軽さの重要性。
  - web上でgit操作する方法を調べ、実践しました。

- DBのmaster/slave構成性について学びました。  
→データを複製して冗長性や読み込みパフォーマンスを向上させる仕組み。レプリケーションにより別DBにバイナリログを転送、slaveに適用する。

- Linux Ubuntu
  - `apt autoremove`は必要のなくなった依存関係のパッケージを自動的に判断して削除してくれるコマンド。
  - 日本語入力環境ではFcitx5の設定で、入力メソッドを、第一入力に**「キーボード - 日本語」、第二入力に「Mozc」**という組み合わせがスムーズに動く。
  - `sudo apt install gnome-shell-extension-manager`経由でInput Method Panelをインストール。  
→検索ボックスの表示位置を整える。

```
GNOME Shell とその他の関係
​OS（Ubuntu）：コンピューター全体の土台。
​Wayland/X11：アプリケーションとデスクトップ環境の間で、グラフィック描画などの通信を行うためのプロトコル。
​GNOME Shell：WaylandやX11と連携して、UIの見た目や操作を管理する。
​Fcitx5：GNOME Shell上で動作する日本語入力システム
```

- picoCTF
  - .dd.gzのディスクイメージのフォレンジック問題を解きました。  
→まずgzipで解凍。その後、stringsとgrepをパイプラインで繋げて使用したり、`strings file.dd > strings_output.txt`でテキストに書き出したり。マウントしたり。

- BLE、またMQTTとCoAP通信の違いについて学びました。  
→BLEは低レイヤープロトコル。MQTTとCoAPはアプリケーション層のプロトコル。
  - MQTT:TCP、非同期、Pub/Sub
  - CoAP:UDP、即時、サーバークライアント型

- Python:Kaggle
  - docstringとjavadocの違いを学びました。  
→javadocは実行時に無視されるコメントだが、docstringは実行時に存在する。基本は複数行文字列だが、何処にも代入していない場合は、コメントのように扱える。
  - True,Falseの扱いがJavaと違うことを学びました。  
→意味のある値が入ってればTrue、空の値ならFalse。0,1が使えるから真偽判定と計算が同時に行える。
  - `not A and not B`は`not (A or B)`に因数分解できる。ドモルガンの法則。
  - returnに条件式を書くのが簡潔な書き方。
  - nullはなく、None。
  - `if not <list>`でnullと空チェックが同時に出来る。
